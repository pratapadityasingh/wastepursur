(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[363],{4416:function(e,t,r){Promise.resolve().then(r.bind(r,9318))},9318:function(e,t,r){"use strict";var a=r(7437),l=r(8472),s=r(6463),c=r(2265),n=r(7138);t.default=()=>{let{pId:e}=(0,s.useParams)(),[t,r]=(0,c.useState)([]),[d,o]=(0,c.useState)(0),[i,u]=(0,c.useState)(null),[p,x]=(0,c.useState)(1),h=e=>{try{let[t,r]=e.split("."),a=atob(r);return JSON.parse(a)}catch(e){return console.error("Error decoding JWT token:",e.message),null}},m=async()=>{let e=h(localStorage.getItem("jwt")||"");try{let t=await l.Z.get("".concat("https://wastepursur.onrender.com","/api/cart/getcart/").concat(e.userId));localStorage.setItem("count",null==t?void 0:t.data.length),r(t.data)}catch(e){console.error("Error fetching product by ID:",e)}};(0,c.useEffect)(()=>{m()},[]),(0,c.useEffect)(()=>{o(t.map(e=>{var t;return(null===(t=e.product)||void 0===t?void 0:t.price)*e.totalQuantity}).reduce((e,t)=>e+t,0))},[t]);let y=async e=>{let a=h(localStorage.getItem("jwt")||"");try{await l.Z.delete("".concat("https://wastepursur.onrender.com","/api/cart/cart/").concat(a.userId,"/").concat(e)),r(t.filter(t=>t.product._id!==e))}catch(e){console.error("Error deleting product from cart:",e)}},v=e=>{u(e);let r=t.find(t=>{var r;return(null===(r=t.product)||void 0===r?void 0:r._id)===e});x(r?r.totalQuantity:1)},j=async e=>{if(p<1){alert("Quantity must be at least 1");return}try{let a=h(localStorage.getItem("jwt")||"");await l.Z.put("".concat("https://wastepursur.onrender.com","/api/cart/cart/").concat(a.userId,"/").concat(e),{quantity:p}),r(t.map(t=>(t.product._id===e&&(t.totalQuantity=p),t))),u(null)}catch(e){console.error("Error updating product quantity:",e)}};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"container mx-auto py-8 pt-[100px] h-screen bg-[#060B27] ",children:(0,a.jsxs)("div",{className:" flex-col justify-center items-center align-baseline",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Cart"}),t.length>0?(0,a.jsx)("div",{className:"overflow-x-auto w-full flex justify-center text-white ",children:(0,a.jsxs)("table",{className:"table-auto w-[1200px] border border-white rounded",children:[(0,a.jsx)("thead",{className:"w-full text-center",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-5",children:"Image"}),(0,a.jsx)("th",{className:"px-4 py-2",children:"Name"}),(0,a.jsx)("th",{className:"px-4 py-2",children:"Description"}),(0,a.jsx)("th",{className:"px-4 py-2",children:"Price"}),(0,a.jsx)("th",{className:"px-4 py-2",children:"Quantity"}),(0,a.jsx)("th",{className:"px-4 py-2",children:"Total"}),(0,a.jsx)("th",{className:"px-4 py-2",children:"Action"})]})}),(0,a.jsxs)("tbody",{className:"w-full text-center",children:[t.map(e=>{var t,r,l,s,c,n,d,o,u;return(0,a.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,a.jsx)("td",{className:"px-4 py-2 flex justify-center",children:(0,a.jsx)("img",{src:null===(t=e.product)||void 0===t?void 0:t.url,alt:null===(r=e.product)||void 0===r?void 0:r.name,className:"h-16 w-18 object-cover rounded-2xl"})}),(0,a.jsx)("td",{className:"px-4 py-2",children:null===(l=e.product)||void 0===l?void 0:l.name}),(0,a.jsx)("td",{className:"px-4 py-2",children:null===(s=e.product)||void 0===s?void 0:s.description}),(0,a.jsxs)("td",{className:"px-4 py-2",children:["$",null===(c=e.product)||void 0===c?void 0:c.price]}),(0,a.jsx)("td",{className:"px-4 py-2",children:i===(null===(n=e.product)||void 0===n?void 0:n._id)?(0,a.jsx)("input",{type:"number",value:p,onChange:e=>x(Math.max(1,Number(e.target.value))),className:"border rounded px-2 py-1 w-16"}):e.totalQuantity}),(0,a.jsxs)("td",{className:"px-4 py-2",children:["$",(null===(d=e.product)||void 0===d?void 0:d.price)*e.totalQuantity]}),(0,a.jsxs)("td",{className:"px-4 py-2",children:[i===(null===(o=e.product)||void 0===o?void 0:o._id)?(0,a.jsx)("button",{onClick:()=>{var t;return j(null===(t=e.product)||void 0===t?void 0:t._id)},className:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-2 rounded",children:"Update"}):(0,a.jsx)("button",{onClick:()=>{var t;return v(null===(t=e.product)||void 0===t?void 0:t._id)},className:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-2 rounded",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>{var t;return y(null===(t=e.product)||void 0===t?void 0:t._id)},className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded ml-2",children:"Delete"})]})]},null===(u=e.product)||void 0===u?void 0:u._id)}),(0,a.jsxs)("tr",{className:"border-t border-gray-600",children:[(0,a.jsx)("td",{className:"px-4 py-2"}),(0,a.jsx)("td",{className:"px-4 py-2"}),(0,a.jsx)("td",{className:"px-4 py-2 font-bold",children:"Total:"}),(0,a.jsxs)("td",{className:"px-4 py-2 font-bold",children:["$",d]}),(0,a.jsx)("td",{className:"px-4 py-2 gap-11",children:(0,a.jsx)(n.default,{href:"/address",passHref:!0,children:(0,a.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded ml-2",children:"Buy now"})})})]})]})]})}):(0,a.jsx)("p",{className:"mt-4",children:"No products in the cart."})]})})})}}},function(e){e.O(0,[291,472,971,23,744],function(){return e(e.s=4416)}),_N_E=e.O()}]);